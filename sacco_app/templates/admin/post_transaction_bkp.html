{% extends "base.html" %}
{% block content %}

<form id="postSavingsForm" method="POST" action="{{ url_for('admin.post_savings_transaction') }}">
    {{ form.hidden_tag() }}
    <div class="mb-3">
        {{ form.member_no.label }}
        {{ form.member_no(class="form-control", id="member_no") }}
    </div>
    <div class="mb-3">
        {{ form.amount.label }}
        {{ form.amount(class="form-control") }}
    </div>
    <div class="mb-3">
        {{ form.bank_txn_date.label }}
        {{ form.bank_txn_date(class="form-control", type="date") }}
    </div>
    <div class="mb-3">
        {{ form.narration.label }}
        {{ form.narration(class="form-control") }}
    </div>
    <button type="submit" class="btn btn-success">Post Savings</button>
</form>


<script>
$(function() {
    $('#postSavingsForm').on('submit', function(e) {
        e.preventDefault();

        $.ajax({
            url: "{{ url_for('admin.post_savings_transaction') }}",
            method: "POST",
            data: $(this).serialize(),
            success: function(response) {
                if (response.success) {
                    alert("✅ Savings posted successfully!\nTxn No: " + response.txn_no);
                    $('#postSavingsForm')[0].reset();
                } else {
                    alert("❌ " + response.error);
                }
            },
            error: function(xhr) {
                alert("❌ An error occurred: " + xhr.responseText);
            }
        });
    });
});
</script>
{% endblock %}
