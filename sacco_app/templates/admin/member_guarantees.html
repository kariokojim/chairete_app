{% extends "base.html" %}

{% block content %}

<h5 class="mb-3">Member Guarantees Enquiry</h5>

<form method="POST" class="card p-3 mb-4">
  <div class="row align-items-end">
    <div class="col-md-3">
      <label class="form-label">Member Number</label>
      <input type="text" name="member_no"
             class="form-control"
             value="{{ member_no or '' }}"
             required>
    </div>

    <div class="col-md-2">
      <button class="btn btn-primary w-100">
        View Guarantees
      </button>
    </div>
  </div>
</form>
{% if guarantees %}
<div class="card">
  <div class="card-header">
    Guaranteed Loans
  </div>

  <div class="card-body p-0">
    <table class="table table-bordered mb-0">
      <thead class="table-light">
        <tr>
          <th>Loan No</th>
          <th>Borrower No</th>
          <th>Borrower Name</th>
          <th>Amount Guaranteed</th>
        </tr>
      </thead>
      <tbody>
        {% for g in guarantees %}
        <tr>
          <td>{{ g.loan_no }}</td>
          <td>{{ g.borrower_no }}</td>
          <td>{{ g.borrower_name or 'N/A' }}</td>
          <td class="text-end">
            {{ "{:,.2f}".format(g.amount_guaranteed) }}
          </td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>

  <div class="card-footer text-end fw-bold">
    Total Guaranteed: {{ "{:,.2f}".format(total_guaranteed) }}
  </div>
</div>

{% elif member_no %}
<div class="alert alert-warning">
  No guarantees found for this member.
</div>
{% endif %}

{% endblock %}
