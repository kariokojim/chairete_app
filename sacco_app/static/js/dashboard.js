window.addEventListener('DOMContentLoaded', async function(){ const data = window.__SACCO_DASH_DATA || await (await fetch('/admin/dashboard/data')).json(); function waitChart(){return new Promise(res=>{ if(window.Chart) return res(); var i=setInterval(()=>{ if(window.Chart){ clearInterval(i); res(); } },100); }); } await waitChart(); try{ new Chart(document.getElementById('barChart').getContext('2d'), {type:'bar', data:{labels:data.months,datasets:[{label:'Loans',data:data.loans, backgroundColor:'#007bff'},{label:'Savings',data:data.savings, backgroundColor:'#66b2ff'}]}}); new Chart(document.getElementById('pieChart').getContext('2d'), {type:'pie', data:{labels:['Loans','Savings'], datasets:[{data:[data.loan_total,data.savings_total], backgroundColor:['#007bff','#66b2ff']} ]}}); }catch(e){console.error(e);} });